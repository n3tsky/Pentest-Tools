########################################
# Reverse
########################################
function f_install_tools_reverse() {
  prefix="$directory/reverse"
  f_print "\n[*] Install reverse tools ($prefix)"

  # OllyDBG
  f_dl_wget "OllyDBG" "http://www.ollydbg.de/odbg201.zip" "/tmp/olly.zip"
  f_quiet_unzip_and_remove "/tmp/olly.zip" "$prefix/ollyDBG2"
  # Immunity
  token="$($CURL -s "https://debugger.immunityinc.com/ID_register.py" | $GREP -i csrfmiddlewaretoken | $SED "s/.*value='\([^ ]*\)'.*/\1/")"
  hash="$($CURL -s -d "address=a&company=a&csrfmiddlewaretoken=$token&email=a@a.com&fullname=a" -H "Referer: https://debugger.immunityinc.com/ID_register.py" -b "csrftoken=$token" "https://debugger.immunityinc.com/ID_register.py" | $GREP ID | $SED "s/.*hash=\([^ ]*\)><.*/\1/")"
  f_dl_wget "ImmunityDebugger" "https://debugger.immunityinc.com/getID.py?hash=$hash" "$prefix/immunityDebugger.exe"
  # Radare2
  f_dl_git "Radare2" "https://github.com/radare/radare2.git" "$prefix/radare2"
  # Hopper - Free
  f_dl_wget "Hopper" "https://d2ap6ypl1xbe4k.cloudfront.net/Hopper-v4-4.3.26-Linux.deb" "/tmp/hopper.deb"
  $SUDO $DPKG -i "/tmp/hopper.deb"
  $RM "/tmp/hopper.deb"

  f_print "\n[*] Install reverse tools - done" "ok"
}
